<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Judul akan diubah oleh JavaScript -->
    <title>GAMITAS - Aplikasi Keselamatan Terpadu</title>

    <link rel="manifest" href="" />
    <link rel="icon" href="assets/fav_icon.png" type="image/png" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="apple-touch-icon" href="assets/fav_icon.png" />

    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css"
      rel="stylesheet"
    />

    <style>
      /* === GLOBAL RESET & BASE === */
      :root {
        --primary-color: #d32f2f;
        --primary-color-dark: #b71c1c;
        --secondary-color: #ff7043;
        --background-color: #f4f6f8;
        --text-color: #212121;
        --text-color-light: #757575;
        --card-bg: #ffffff;
        --header-bg: #ffffff;
        --border-color: #eeeeee;
        --tab-active-bg: #d32f2f;
        --gamitas-green: #1b5e20; /* Dark Green */
      }
      * {
        box-sizing: border-box;
      }
      html {
        height: 100%;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #e9e9ef;
        color: var(--text-color);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        font-size: 13.5px; /* Base font size adjustment */
      }

      /* === MOBILE FRAME WRAPPER === */
      .mobile-wrapper {
        width: 100%;
        height: 100%;
        max-width: 450px;
        max-height: 950px;
        background-color: var(--background-color);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        border-radius: 20px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* === MAIN APP STRUCTURE === */
      #app-container,
      #login-screen,
      #register-screen {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
      }

      .scrollable-content {
        flex-grow: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }

      /* === ANIMATION KEYFRAMES === */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }
      @keyframes spin3d {
        from {
          transform: rotateY(0deg);
        }
        to {
          transform: rotateY(360deg);
        }
      }
      @keyframes drive-across {
        0% {
          transform: translateX(-60px);
        }
        100% {
          transform: translateX(60px);
        }
      }
      @keyframes draw-checkmark {
        to {
          stroke-dashoffset: 0;
        }
      }
      @keyframes blink-red {
        0%,
        100% {
          background-color: transparent;
        }
        50% {
          background-color: rgba(211, 47, 47, 0.15);
        }
      }

      /* === SPLASH SCREEN === */
      #splash-screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--card-bg);
        z-index: 10000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: opacity 0.5s ease-out;
      }
      .splash-logo {
        width: 110px;
        margin-bottom: 20px;
      }
      .verified-container {
        display: flex;
        align-items: center;
        gap: 8px;
        opacity: 0;
        transform: scale(0.8);
        transition: opacity 0.4s ease-in, transform 0.4s ease-in;
      }
      #splash-screen.show-verified .verified-container {
        opacity: 1;
        transform: scale(1);
      }
      .verified-checkmark {
        width: 24px;
        height: 24px;
      }
      .verified-checkmark path {
        stroke: #4caf50;
        stroke-width: 3;
        stroke-dasharray: 100;
        stroke-dashoffset: 100;
        animation: draw-checkmark 0.5s 0.5s ease-in-out forwards;
      }
      .verified-text {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-color);
      }

      /* === LOGIN & REGISTER SCREEN STYLES === */
      #login-screen,
      #register-screen {
        background-color: var(--header-bg);
        padding: 24px;
        text-align: center;
        justify-content: center;
        align-items: center;
        overflow-y: auto;
      }
      .form-container {
        width: 100%;
        max-width: 400px;
        margin: auto;
      }
      .company-logo {
        width: 100px;
        height: auto;
        margin-bottom: 16px;
        animation: fadeInUp 0.5s ease-out;
      }
      .form-container .logo {
        font-weight: bold;
        font-size: 40px;
        color: var(--primary-color);
        margin-bottom: 16px;
        animation: fadeInUp 0.5s ease-out;
      }
      .form-container h2 {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 8px;
        animation: fadeInUp 0.5s ease-out 0.1s;
        animation-fill-mode: both;
      }
      .form-container p {
        font-size: 14px;
        color: var(--text-color-light);
        margin-bottom: 30px;
        animation: fadeInUp 0.5s ease-out 0.2s;
        animation-fill-mode: both;
      }
      .login-choices {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .login-choice-btn {
        display: flex;
        align-items: center;
        padding: 14px;
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: left;
        animation: fadeInUp 0.5s ease-out;
        animation-fill-mode: both;
        color: var(--text-color);
        text-decoration: none;
      }
      .login-choice-btn:nth-child(1) {
        animation-delay: 0.3s;
      }
      .login-choice-btn:nth-child(2) {
        animation-delay: 0.4s;
      }
      .login-choice-btn:nth-child(3) {
        animation-delay: 0.5s;
      }
      .login-choice-btn:nth-child(4) {
        animation-delay: 0.6s;
      }

      .login-choice-btn:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-color: var(--primary-color);
      }
      .login-choice-btn img {
        width: 36px;
        height: 36px;
        margin-right: 16px;
      }
      .login-choice-btn .btn-text h4 {
        margin: 0 0 4px 0;
        font-size: 13px;
        font-weight: 600;
      }
      .login-choice-btn .btn-text p {
        margin: 0;
        font-size: 11px;
        color: var(--text-color-light);
      }
      .register-link {
        margin-top: 24px;
        font-size: 12px;
        color: var(--text-color-light);
        animation: fadeInUp 0.5s ease-out 0.7s;
        animation-fill-mode: both;
      }
      .register-link a {
        color: var(--primary-color);
        font-weight: 600;
        text-decoration: none;
      }

      .login-choice-btn .simper-icon-wrapper {
        width: 40px;
        height: 40px;
        margin-right: 16px;
        overflow: hidden;
        position: relative;
      }
      .login-choice-btn .car-img {
        position: absolute;
        width: 40px;
        height: 40px;
        animation: drive-across 3s linear infinite;
      }

      /* === REGISTER FORM STYLES === */
      .register-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
        text-align: left;
      }
      .register-form .form-group {
        display: flex;
        flex-direction: column;
      }
      .register-form label {
        margin-bottom: 6px;
        font-weight: 500;
        font-size: 14px;
      }
      .register-form input {
        padding: 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        font-size: 14px;
      }
      .register-form button {
        padding: 14px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 16px;
      }

      /* === LANGUAGE SWITCHER (NEW) === */
      .language-switcher {
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: center;
      }
      .language-switcher-login {
        margin-top: 24px;
      }
      .lang-btn {
        background-color: transparent;
        border: 2px solid transparent;
        border-radius: 50%;
        padding: 0;
        cursor: pointer;
        width: 32px;
        height: 32px;
        overflow: hidden;
        transition: all 0.3s ease;
        opacity: 0.6;
      }
      .lang-btn:hover {
        opacity: 1;
        transform: scale(1.1);
      }
      .lang-btn.active {
        border-color: var(--primary-color);
        opacity: 1;
        transform: scale(1.1);
        box-shadow: 0 0 8px rgba(211, 47, 47, 0.5);
      }
      .lang-btn img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .language-switcher-header .lang-btn {
        width: 28px;
        height: 28px;
      }

      /* === UTILITIES & PAGE TRANSITIONS === */
      .page {
        display: none;
      }
      .page.active {
        display: block;
        animation: fadeIn 0.4s ease-in-out;
      }

      /* === APP HEADER (REVAMPED) === */
      .app-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        background-color: var(--header-bg);
        flex-shrink: 0;
        position: sticky;
        top: 0;
        z-index: 100;
        transition: top 0.3s ease-in-out;
        border-bottom: 1px solid var(--border-color);
      }
      .app-header.hidden {
        top: -100px;
      }
      .header-left-section {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .header-left-section img {
        height: 30px;
      }
      .app-header .logo {
        font-weight: bold;
        font-size: 22px;
        color: var(--gamitas-green);
      }
      .header-right-section {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .profile-dropdown {
        position: relative;
      }
      .profile-btn {
        background-color: transparent;
        border: none;
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
      }
      .profile-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background-color: var(--primary-color);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 14px;
      }
      .profile-dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        top: 45px;
        background-color: white;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 8px;
        overflow: hidden;
      }
      .profile-dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 14px;
      }
      .profile-dropdown-content a:hover {
        background-color: #f1f1f1;
      }
      .profile-dropdown-content a svg {
        width: 16px;
        height: 16px;
        stroke: #555;
      }
      .profile-dropdown:hover .profile-dropdown-content {
        display: block;
      }

      /* === USER PROFILE SECTION === */
      .user-profile {
        padding: 24px 16px;
        background-color: var(--header-bg);
        border-bottom: 1px solid var(--border-color);
        flex-shrink: 0;
      }
      .user-profile .greeting p {
        margin: 0 0 2px 0;
        font-size: 13px;
        color: var(--text-color-light);
      }
      .user-profile .greeting h2 {
        margin: 0;
        font-size: clamp(17px, 5vw, 19px);
        font-weight: 600;
      }

      /* === TAB NAVIGATION === */
      .main-tabs {
        display: flex;
        gap: 10px;
        padding: 0 16px 20px 16px;
        background-color: var(--header-bg);
        overflow-x: auto;
        flex-shrink: 0;
      }
      .main-tabs .tab {
        padding: 8px 20px;
        border-radius: 20px;
        background-color: #e0e0e0;
        color: var(--text-color-light);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        white-space: nowrap;
      }
      .main-tabs .tab:not(.active):hover {
        background-color: #d0d0d0;
      }
      .main-tabs .tab.active {
        background-color: var(--tab-active-bg);
        color: white;
      }

      /* === MAIN CONTENT & CARDS === */
      main {
        padding: 16px;
      }

      /* === CAROUSEL BANNER === */
      .carousel-container {
        position: relative;
        overflow: hidden;
        border-radius: 20px;
        margin-bottom: 24px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        animation: fadeInUp 0.5s ease-out;
      }
      .carousel-track {
        display: flex;
        transition: transform 0.5s ease-in-out;
      }
      .carousel-slide {
        min-width: 100%;
        background: linear-gradient(
          105deg,
          var(--primary-color),
          var(--secondary-color)
        );
        color: white;
        border-radius: 20px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        height: 160px;
      }
      .carousel-slide.video-slide {
        padding: 0;
        background: black;
      }
      .carousel-slide video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 20px;
      }
      .carousel-slide .card-title {
        font-size: 13px;
        font-weight: 600;
        opacity: 0.8;
        margin: 0 0 8px 0;
        text-transform: uppercase;
      }
      .carousel-slide .card-content {
        font-size: 16px;
        font-weight: bold;
        line-height: 1.4;
      }
      .carousel-dots {
        position: absolute;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
      }
      .carousel-dots .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.5);
        transition: background-color 0.3s;
        cursor: pointer;
      }
      .carousel-dots .dot.active {
        background-color: white;
      }
      .mute-btn {
        position: absolute;
        top: 16px;
        right: 16px;
        background-color: rgba(0, 0, 0, 0.5);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 10;
      }
      .mute-btn svg {
        width: 20px;
        height: 20px;
        stroke: white;
      }

      /* === SECTION TITLE === */
      .section-title {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        animation: fadeInUp 0.5s ease-out 0.1s;
        animation-fill-mode: both;
      }
      .section-title h2 {
        margin: 0;
        font-size: 16px;
      }
      .section-title a {
        font-size: 13px;
        color: var(--primary-color);
        text-decoration: none;
      }

      /* === FEATURE GRID === */
      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 16px;
      }
      .feature-card {
        background-color: var(--card-bg);
        border-radius: 16px;
        padding: 12px;
        text-align: center;
        text-decoration: none;
        color: var(--text-color);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        animation: fadeInUp 0.5s ease-out;
        animation-fill-mode: both;
      }
      .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
      }
      .feature-card .icon-wrapper {
        background-color: #feeceb;
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0 auto 12px auto;
      }
      .feature-card img {
        width: 28px;
        height: 28px;
      }
      .feature-card p {
        margin: 0;
        font-size: 11.5px;
        font-weight: 500;
      }

      /* === FOOTER NAVIGATION (ROBUST & RESPONSIVE) === */
      .footer-nav {
        background-color: var(--card-bg);
        border-top: 1px solid var(--border-color);
        box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05);
        flex-shrink: 0;
        width: 100%;
      }
      .footer-nav ul {
        display: flex;
        justify-content: space-around;
        align-items: stretch; /* Make items fill height */
        margin: 0;
        padding: 6px 0;
        list-style: none;
        width: 100%;
      }
      .footer-nav li {
        flex: 1; /* CRITICAL CHANGE: Each item takes equal space */
        display: flex;
      }
      .footer-nav li a {
        display: flex;
        flex-direction: column;
        justify-content: center; /* Center content vertically */
        align-items: center;
        text-decoration: none;
        color: var(--text-color-light);
        font-size: 10px;
        padding: 4px 2px;
        position: relative;
        text-align: center;
        width: 100%; /* Make link fill the list item */
        transition: color 0.2s;
      }
      .footer-nav li#nav-emergency a {
        animation: blink-red 1.5s infinite ease-in-out;
        border-radius: 12px;
      }
      .footer-nav li a svg {
        width: 22px;
        height: 22px;
        margin-bottom: 4px;
        stroke: var(--text-color-light);
        transition: stroke 0.2s;
      }
      .footer-nav li.active a,
      .footer-nav li a:hover {
        color: var(--primary-color);
      }
      .footer-nav li.active a svg,
      .footer-nav li a:hover svg {
        stroke: var(--primary-color);
      }
      .footer-nav li.active a::after {
        content: "";
        position: absolute;
        bottom: -6px;
        left: 50%;
        transform: translateX(-50%);
        width: 40%;
        height: 3px;
        background-color: var(--primary-color);
        border-radius: 2px;
      }

      /* === Other Pages (Kompetensi, Kartu, Jadwal) === */
      .page-content {
        padding: 16px;
      }
      .page-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 24px;
      }
      #page-kartudigital.active .kompetent-card {
        animation: fadeInUp 0.5s ease-out;
      }
      .kompetent-card {
        background-color: #d60000;
        color: #fff;
        padding: 20px;
        border-radius: 12px;
        margin: 20px auto;
        max-width: 500px;
        perspective: 1000px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      }
      #page-jadwal.active #calendar {
        animation: fadeInUp 0.5s ease-out;
      }
      #calendar {
        max-width: 100%;
        margin: 20px auto;
      }
      .modal {
        display: none;
        position: fixed;
        z-index: 1001;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
      }
      .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 400px;
      }
      .close {
        color: #aaa;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
      }
      .close:hover {
        color: #000;
      }
      #page-kompetensi.active .search-container {
        animation: fadeInUp 0.5s ease-out;
      }
      .search-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin-bottom: 30px;
      }
      .search-container input[type="text"] {
        flex: 1;
        min-width: 200px;
        padding: 10px 14px;
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        font-size: 14px;
      }
      .search-container button {
        padding: 10px 18px;
        font-size: 14px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }
      .search-container button:first-of-type {
        background-color: var(--primary-color);
        color: white;
      }
      .search-container .reset-btn {
        background-color: #f0f0f0;
        color: var(--text-color);
        border: 1px solid #ccc;
      }
      .loading-text {
        text-align: center;
        font-style: italic;
        color: #555;
        margin-top: 10px;
      }
      .result-section {
        margin-top: 24px;
        padding: 0;
      }
      .result-section h2 {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 16px;
        color: var(--text-color);
      }

      /* === COMPETENCY GRID STYLES === */
      .grid-4 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 16px;
      }
      .grid-card {
        background-color: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        padding: 16px 12px;
        text-align: center;
        width: 100%;
        box-sizing: border-box;
        transition: transform 0.2s ease;
        opacity: 0;
        animation: fadeInUp 0.5s ease-out forwards;
      }
      .grid-card:hover {
        transform: translateY(-4px);
      }
      .grid-card img {
        width: 40px;
        height: 40px;
        margin-bottom: 12px;
      }
      .grid-card p {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-color);
        margin: 0;
      }

      /* === INDUCTION & ACTION BUTTONS === */
      .action-btn {
        display: inline-block;
        padding: 16px 32px;
        color: white;
        text-decoration: none;
        font-weight: 600;
        font-size: 16px;
        border-radius: 12px;
        transition: background-color 0.3s, transform 0.3s;
        width: 100%;
        text-align: center;
      }
      .action-btn.primary {
        background-color: var(--primary-color);
      }
      .action-btn.primary:hover {
        background-color: var(--primary-color-dark);
        transform: translateY(-2px);
      }
      .action-btn.secondary {
        background-color: var(--secondary-color);
        margin-bottom: 16px;
      }
      .action-btn.secondary:hover {
        background-color: #e65100;
        transform: translateY(-2px);
      }

      .instruction-box {
        background-color: #fff9c4;
        border: 1px solid #fbc02d;
        color: #3e2723;
        padding: 16px;
        border-radius: 8px;
        font-size: 14px;
        line-height: 1.7;
      }

      /* === EMERGENCY PAGE STYLES === */
      .emergency-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .emergency-item {
        display: flex;
        align-items: center;
        background-color: var(--card-bg);
        padding: 14px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        animation: fadeInUp 0.5s ease-out forwards;
      }
      .emergency-item .icon-wrapper {
        flex-shrink: 0;
        margin-right: 16px;
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }
      .emergency-item .icon-wrapper svg {
        width: 24px;
        height: 24px;
      }
      .emergency-item .contact-info {
        flex-grow: 1;
      }
      .emergency-item .contact-info h3 {
        margin: 0 0 4px 0;
        font-size: 15px;
      }
      .emergency-item .contact-info p {
        margin: 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--primary-color);
      }
      .emergency-item .action-buttons {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-shrink: 0;
      }
      .emergency-item .call-btn {
        padding: 10px 15px; /* Adjust padding */
        background-color: #4caf50;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        font-size: 14px;
        transition: background-color 0.2s;
      }
      .emergency-item .whatsapp-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background-color: #25d366;
        border-radius: 50%;
        transition: background-color 0.2s;
      }
      .emergency-item .whatsapp-btn svg {
        width: 24px;
        height: 24px;
        fill: white;
      }
      .emergency-item .call-btn:hover {
        background-color: #45a049;
      }
      .emergency-item .whatsapp-btn:hover {
        background-color: #1da851;
      }

      /* === FILOSOFI PAGE === */
      .filosofi-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        border-bottom: 1px solid var(--border-color);
      }
      .filosofi-tab-btn {
        padding: 10px 20px;
        border: none;
        background-color: transparent;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        color: var(--text-color-light);
        border-bottom: 3px solid transparent;
        transition: color 0.3s, border-color 0.3s;
      }
      .filosofi-tab-btn.active {
        color: var(--primary-color);
        border-bottom-color: var(--primary-color);
      }
      .filosofi-tab-content {
        display: none;
      }
      .filosofi-tab-content.active {
        display: block;
      }
      .filosofi-content {
        text-align: center;
        perspective: 1000px;
      }
      .filosofi-content img {
        max-width: 150px;
        margin-bottom: 24px;
      }
      .filosofi-section {
        background-color: var(--card-bg);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 20px;
        text-align: left;
        opacity: 0;
        animation: fadeInUp 0.5s ease-out forwards;
        transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        cursor: pointer;
        position: relative;
        z-index: 1;
        font-size: 14px;
      }
      .filosofi-section.zoomed {
        transform: scale(1.05);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        z-index: 2;
      }
      .filosofi-section h3 {
        margin-top: 0;
        color: var(--primary-color);
      }
      .filosofi-section ul {
        padding-left: 20px;
        list-style: none;
      }
      .filosofi-section ul li {
        margin-bottom: 10px;
        line-height: 1.6;
      }
      .filosofi-section ul li strong {
        color: var(--text-color);
      }
    </style>
  </head>
  <body>
    <div class="mobile-wrapper">
      <div id="splash-screen">
        <img src="assets/logo.png" alt="Logo Perusahaan" class="splash-logo" />
        <div class="verified-container">
          <svg
            class="verified-checkmark"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 52 52"
          >
            <path d="M14.1 27.2l7.1 7.2 16.7-16.8" />
          </svg>
          <span class="verified-text" data-translate="splash_verified"
            >Verified</span
          >
        </div>
      </div>
      <div id="login-screen" style="display: none">
        <div class="form-container">
          <img
            src="assets/logo.png"
            alt="Logo Perusahaan"
            class="company-logo"
          />
          <div class="logo">GAMITAS</div>
          <h2 data-translate="login_welcome">Selamat Datang</h2>
          <p data-translate="login_select_type">
            Pilih tipe login untuk melanjutkan
          </p>
          <div class="login-choices">
            <div class="login-choice-btn" onclick="login('Karyawan GAM')">
              <img
                src="assets/Logo PT GAM PNG tok.png"
                alt="Ikon Karyawan GAM"
              />
              <div class="btn-text">
                <h4 data-translate="login_as_gam">
                  Login sebagai Karyawan GAM
                </h4>
                <p data-translate="login_as_gam_desc">
                  Akses fitur untuk internal perusahaan
                </p>
              </div>
            </div>
            <div class="login-choice-btn" onclick="login('Mitra Kerja')">
              <img
                src="https://cdn-icons-png.flaticon.com/512/9187/9187513.png"
                alt="Ikon Mitra"
              />
              <div class="btn-text">
                <h4 data-translate="login_as_partner">
                  Login sebagai Mitra Kerja
                </h4>
                <p data-translate="login_as_partner_desc">
                  Akses fitur untuk vendor dan kontraktor
                </p>
              </div>
            </div>
            <a href="training_center.html" class="login-choice-btn">
              <div class="simper-icon-wrapper">
                <img
                  class="car-img"
                  src="https://cdn-icons-png.flaticon.com/512/10473/10473321.png"
                  alt="Ikon Mobil"
                />
              </div>
              <div class="btn-text">
                <h4 data-translate="login_simper_test">Tes SIMPER</h4>
                <p data-translate="login_simper_test_desc">
                  Akses untuk mengikuti tes SIMPER
                </p>
              </div>
            </a>
            <a
              href="ptw_home.html"
              class="login-choice-btn"
              onclick="showPage('page-pengajuan')"
            >
              <img
                src="https://cdn-icons-png.flaticon.com/512/2991/2991108.png"
                alt="Ikon Pengajuan"
              />
              <div class="btn-text">
                <h4 data-translate="login_submission">PENGAJUAN</h4>
                <p data-translate="login_submission_desc">
                  PERMIT TO WORK, SURAT IJIN MASUK SITE dll
                </p>
              </div>
            </a>
          </div>
          <p class="register-link">
            <span data-translate="login_no_account">Belum punya akun?</span>
            <a
              href="#"
              onclick="showRegisterForm()"
              data-translate="login_register_now"
              >Daftar sekarang</a
            >
          </p>
          <div class="language-switcher language-switcher-login">
            <button class="lang-btn" data-lang="id" onclick="setLanguage('id')">
              <img
                src="https://flagcdn.com/w40/id.png"
                alt="Bendera Indonesia"
              />
            </button>
            <button class="lang-btn" data-lang="en" onclick="setLanguage('en')">
              <img src="https://flagcdn.com/w40/gb.png" alt="Bendera Inggris" />
            </button>
            <button class="lang-btn" data-lang="ko" onclick="setLanguage('ko')">
              <img
                src="https://flagcdn.com/w40/kr.png"
                alt="Bendera Korea Selatan"
              />
            </button>
          </div>
        </div>
      </div>

      <div id="register-screen" style="display: none">
        <div class="form-container">
          <img
            src="assets/logo.png"
            alt="Logo Perusahaan"
            class="company-logo"
          />
          <div class="logo">GAMITAS</div>
          <h2 data-translate="register_create_account">Buat Akun Baru</h2>
          <form class="register-form" onsubmit="handleRegister(event)">
            <div class="form-group">
              <label for="reg-nama" data-translate="register_fullname"
                >Nama Lengkap</label
              >
              <input type="text" id="reg-nama" required />
            </div>
            <div class="form-group">
              <label for="reg-nik" data-translate="register_id_card"
                >NIK KTP</label
              >
              <input type="text" id="reg-nik" required />
            </div>
            <div class="form-group">
              <label for="reg-email" data-translate="register_email"
                >Email</label
              >
              <input type="email" id="reg-email" required />
            </div>
            <div class="form-group">
              <label for="reg-wa" data-translate="register_whatsapp"
                >No. WhatsApp</label
              >
              <input
                type="tel"
                id="reg-wa"
                required
                pattern="^(08|\+628)\d{8,11}$"
                title="Gunakan format 08... atau +628..."
              />
            </div>
            <div class="form-group">
              <label for="reg-perusahaan" data-translate="register_company"
                >Perusahaan</label
              >
              <input type="text" id="reg-perusahaan" required />
            </div>
            <button type="submit" data-translate="register_now_btn">
              Daftar Sekarang
            </button>
          </form>
          <p class="register-link">
            <span data-translate="register_have_account"
              >Sudah punya akun?</span
            >
            <a
              href="#"
              onclick="showLoginForm()"
              data-translate="register_login"
              >Login</a
            >
          </p>
        </div>
      </div>

      <div id="app-container" style="display: none">
        <header class="app-header">
          <div class="header-left-section">
            <img src="assets/logo.png" alt="Logo" />
            <div class="logo">GAMITAS</div>
          </div>
          <div class="header-right-section">
            <div class="language-switcher language-switcher-header">
              <button
                class="lang-btn"
                data-lang="id"
                onclick="setLanguage('id')"
              >
                <img
                  src="https://flagcdn.com/w40/id.png"
                  alt="Bendera Indonesia"
                />
              </button>
              <button
                class="lang-btn"
                data-lang="en"
                onclick="setLanguage('en')"
              >
                <img
                  src="https://flagcdn.com/w40/gb.png"
                  alt="Bendera Inggris"
                />
              </button>
              <button
                class="lang-btn"
                data-lang="ko"
                onclick="setLanguage('ko')"
              >
                <img
                  src="https://flagcdn.com/w40/kr.png"
                  alt="Bendera Korea Selatan"
                />
              </button>
            </div>
            <div class="profile-dropdown">
              <button class="profile-btn">
                <span id="header-user-name" style="font-weight: 600"></span>
                <div class="profile-avatar" id="profile-initial">?</div>
              </button>
              <div class="profile-dropdown-content">
                <a href="#">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                  </svg>
                  <span data-translate="menu_profile">Profil</span>
                </a>
                <a href="#" onclick="logout()">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                    <polyline points="16 17 21 12 16 7" />
                    <line x1="21" y1="12" x2="9" y2="12" />
                  </svg>
                  <span data-translate="menu_logout">Keluar</span>
                </a>
              </div>
            </div>
          </div>
        </header>

        <div class="scrollable-content">
          <div id="page-home" class="page">
            <section class="user-profile">
              <div class="greeting">
                <p id="time-greeting">Selamat Pagi,</p>
                <h2 id="user-greeting">Pengguna!</h2>
              </div>
            </section>

            <section class="main-tabs">
              <div class="tab active" data-translate="tabs_dashboard">
                Dashboard
              </div>
              <div class="tab" data-translate="tabs_insight">Insight</div>
              <div class="tab" data-translate="tabs_report">Laporan</div>
            </section>

            <main>
              <div class="carousel-container">
                <div class="carousel-track">
                  <div class="carousel-slide video-slide">
                    <video
                      src="assets/intro_1.mp4"
                      autoplay
                      muted
                      loop
                      playsinline
                    ></video>
                  </div>
                  <div class="carousel-slide">
                    <p class="card-title" data-translate="carousel_safety_msg">
                      Pesan Keselamatan
                    </p>
                    <p class="card-content" data-translate="carousel_safety_1">
                      Selalu periksa peralatan Anda sebelum memulai pekerjaan.
                    </p>
                  </div>
                  <div class="carousel-slide video-slide">
                    <video
                      src="assets/intro_2.mp4"
                      autoplay
                      muted
                      loop
                      playsinline
                    ></video>
                  </div>
                  <div class="carousel-slide">
                    <p class="card-title" data-translate="carousel_danger_zone">
                      Zona Berbahaya
                    </p>
                    <p class="card-content" data-translate="carousel_safety_2">
                      Waspada area peledakan. Dilarang masuk tanpa izin.
                    </p>
                  </div>
                  <div class="carousel-slide">
                    <p class="card-title" data-translate="carousel_danger_area">
                      Area Berbahaya
                    </p>
                    <p class="card-content" data-translate="carousel_safety_3">
                      Gunakan pelindung telinga di sekitar area genset.
                    </p>
                  </div>
                </div>
                <div class="carousel-dots"></div>
                <button id="mute-btn" class="mute-btn">
                  <svg
                    id="volume-off-icon"
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
                    <line x1="23" y1="9" x2="17" y2="15" />
                    <line x1="17" y1="9" x2="23" y2="15" />
                  </svg>
                  <svg
                    id="volume-on-icon"
                    style="display: none"
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
                    <path d="M15.54 8.46a5 5 0 0 1 0 7.07" />
                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14" />
                  </svg>
                </button>
              </div>

              <!-- Fitur Pilihan -->
              <div class="section-title">
                <h2 data-translate="home_featured">Fitur Pilihan</h2>
              </div>
              <div class="feature-grid">
                <a
                  onclick="showPage('page-induksi')"
                  class="feature-card"
                  style="animation-delay: 0.1s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/3063/3063823.png"
                      alt="Induksi Icon"
                    />
                  </div>
                  <p data-translate="feature_induction">Induksi</p>
                </a>
                <a
                  onclick="showPage('page-jadwal')"
                  class="feature-card"
                  style="animation-delay: 0.15s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/3652/3652191.png"
                      alt="Jadwal Pelatihan Icon"
                    />
                  </div>
                  <p data-translate="feature_schedule">Jadwal</p>
                </a>
                <a
                  onclick="showPage('page-golden-rules')"
                  class="feature-card"
                  style="animation-delay: 0.2s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/3159/3159091.png"
                      alt="Golden Rules Icon"
                    />
                  </div>
                  <p data-translate="feature_golden_rules">Golden Rules</p>
                </a>
                <a
                  onclick="showPage('page-do-dont')"
                  class="feature-card"
                  style="animation-delay: 0.25s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/4225/4225665.png"
                      alt="Do & Don't Icon"
                    />
                  </div>
                  <p data-translate="feature_do_dont">Do & Don't</p>
                </a>
              </div>

              <!-- Buku Saku -->
              <div class="section-title" style="margin-top: 24px">
                <h2 data-translate="home_handbook">Buku Saku</h2>
              </div>
              <div class="feature-grid">
                <a
                  onclick="showPage('page-buku-mekanik')"
                  class="feature-card"
                  style="animation-delay: 0.1s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/2083/2083344.png"
                      alt="Buku Saku Mekanik Icon"
                    />
                  </div>
                  <p data-translate="handbook_mechanic">BS Mekanik</p>
                </a>
                <a
                  href="buku_saku_detail/hd_785.html"
                  class="feature-card"
                  style="animation-delay: 0.15s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/3405/3405818.png"
                      alt="Buku Saku Operator Icon"
                    />
                  </div>
                  <p data-translate="handbook_operator">BS Operator</p>
                </a>
                <a
                  onclick="showPage('page-buku-hse')"
                  class="feature-card"
                  style="animation-delay: 0.2s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/4345/4345634.png"
                      alt="Buku Saku HSE Icon"
                    />
                  </div>
                  <p data-translate="handbook_hse">BS HSE</p>
                </a>
              </div>

              <!-- Menu Lain -->
              <div class="section-title" style="margin-top: 24px">
                <h2 data-translate="home_other_menus">Menu Lain</h2>
              </div>
              <div class="feature-grid">
                <a
                  onclick="showPage('page-filosofi')"
                  class="feature-card"
                  style="animation-delay: 0.1s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/3406/3406831.png"
                      alt="Filosofi Icon"
                    />
                  </div>
                  <p data-translate="feature_philosophy">Filosofi</p>
                </a>
                <a
                  id="menu-kartu-digital"
                  onclick="showPage('page-kartudigital')"
                  class="feature-card"
                  style="animation-delay: 0.15s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/8351/8351110.png"
                      alt="Kartu Digital Icon"
                    />
                  </div>
                  <p data-translate="feature_digital_card">Kartu Digital</p>
                </a>
                <a
                  onclick="showPage('page-kompetensi')"
                  class="feature-card"
                  style="animation-delay: 0.2s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/992/992648.png"
                      alt="Kompetensi Icon"
                    />
                  </div>
                  <p data-translate="feature_competency">Kompetensi</p>
                </a>
                <a
                  onclick="showPage('page-emergency')"
                  class="feature-card"
                  style="animation-delay: 0.25s"
                >
                  <div class="icon-wrapper">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/2927/2927649.png"
                      alt="Nomor Darurat Icon"
                    />
                  </div>
                  <p data-translate="feature_emergency_num">Nomor Darurat</p>
                </a>
              </div>
            </main>
          </div>

          <div id="page-kompetensi" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="competency_title">
                Kompetensi Saya
              </h1>
              <div class="search-container">
                <input
                  type="text"
                  id="search-kompetensi"
                  data-translate-placeholder="competency_search_placeholder"
                  placeholder="ðŸ” Cari nama Anda di sini..."
                />
                <button
                  onclick="searchData()"
                  data-translate="competency_search_btn"
                >
                  Cari
                </button>
                <button
                  class="reset-btn"
                  onclick="resetSearch()"
                  data-translate="competency_reset_btn"
                >
                  Reset
                </button>
              </div>
              <div id="loading" class="loading-text" style="display: none">
                <span data-translate="competency_loading"
                  >ðŸ”„ Memuat data...</span
                >
              </div>
              <div id="results"></div>
            </main>
          </div>

          <div id="page-kartudigital" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="digital_card_title">
                Kartu Digital
              </h1>
              <div class="kompetent-card">
                <div class="card-inner">
                  <section class="card-header">
                    <h1>KOMPETENT CARD</h1>
                    <p>ZERO ACCIDENT</p>
                  </section>
                  <section class="card-content">
                    <h2>10 SUPERVISORY BEHAVIOR PROFILE</h2>
                    <ul class="behavior-list">
                      <li>
                        <span class="badge">1</span
                        ><span data-translate="card_behavior_1"
                          >Memberikan Arahan yang Jelas</span
                        >
                      </li>
                      <li>
                        <span class="badge">2</span
                        ><span data-translate="card_behavior_2"
                          >Membuat Perencanaan Kerja yang Aman</span
                        >
                      </li>
                      <li>
                        <span class="badge">3</span
                        ><span data-translate="card_behavior_3"
                          >Mendelegasikan Tugas Sesuai Kompetensi K3</span
                        >
                      </li>
                      <li>
                        <span class="badge">4</span
                        ><span data-translate="card_behavior_4"
                          >Monitoring &amp; Follow-Up Kegiatan K3</span
                        >
                      </li>
                      <li>
                        <span class="badge">5</span
                        ><span data-translate="card_behavior_5"
                          >Memberikan Dukungan &amp; Fasilitas K3</span
                        >
                      </li>
                      <li>
                        <span class="badge">6</span
                        ><span data-translate="card_behavior_6"
                          >Membangun Komunikasi Positif Mengenai Safety</span
                        >
                      </li>
                      <li>
                        <span class="badge">7</span
                        ><span data-translate="card_behavior_7"
                          >Mengembangkan Kompetensi K3 Tim</span
                        >
                      </li>
                      <li>
                        <span class="badge">8</span
                        ><span data-translate="card_behavior_8"
                          >Memberikan Apresiasi Terhadap Perilaku Aman</span
                        >
                      </li>
                      <li>
                        <span class="badge">9</span
                        ><span data-translate="card_behavior_9"
                          >Mengelola Konflik dan Risiko Sosial</span
                        >
                      </li>
                      <li>
                        <span class="badge">10</span
                        ><span data-translate="card_behavior_10"
                          >Menjadi Teladan dalam Budaya K3</span
                        >
                      </li>
                    </ul>
                  </section>
                  <section class="card-footer">
                    <p data-translate="card_footer">
                      K3 adalah Jalan Ninjaku Menuju Keselamatan
                    </p>
                  </section>
                </div>
              </div>
            </main>
          </div>

          <div id="page-jadwal" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="schedule_title">
                Jadwal Pelatihan
              </h1>
              <div style="text-align: center; margin-bottom: 24px">
                <a
                  href="https://forms.gle/xHLQU5SoMQwNN76P7"
                  target="_blank"
                  class="action-btn primary"
                  style="font-size: 16px; padding: 14px 28px"
                  data-translate="schedule_register_btn"
                  >Pendaftaran Training</a
                >
              </div>
              <div id="calendar"></div>
              <div id="eventModal" class="modal">
                <div class="modal-content">
                  <span class="close">&times;</span>
                  <h3 id="modalTitle"></h3>
                  <p>
                    <strong data-translate="schedule_modal_start"
                      >Tanggal Mulai:</strong
                    >
                    <span id="modalStart"></span>
                  </p>
                  <p>
                    <strong data-translate="schedule_modal_end"
                      >Tanggal Selesai:</strong
                    >
                    <span id="modalEnd"></span>
                  </p>
                </div>
              </div>
            </main>
          </div>

          <div id="page-induksi" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="induction_title">
                Induksi Keselamatan
              </h1>
              <div style="text-align: center; padding: 20px">
                <img
                  src="https://cdn-icons-png.flaticon.com/512/2950/2950450.png"
                  alt="Induksi Icon"
                  style="width: 100px; height: 100px; margin-bottom: 24px"
                />
                <h3 data-translate="induction_ready">Siap untuk Memulai?</h3>
                <p
                  style="
                    color: var(--text-color-light);
                    line-height: 1.6;
                    margin-bottom: 32px;
                  "
                  data-translate="induction_instruction"
                >
                  Silakan lakukan pendaftaran terlebih dahulu sebelum memulai
                  proses induksi keselamatan.
                </p>
                <a
                  href="https://forms.gle/1ohdiHosEgawo7Ja8"
                  target="_blank"
                  class="action-btn secondary"
                  data-translate="induction_register_btn"
                >
                  Pendaftaran Induksi
                </a>
                <a
                  href="kode_akses.html"
                  target="_self"
                  class="action-btn primary"
                  data-translate="induction_start_btn"
                >
                  Mulai Induksi
                </a>
              </div>
            </main>
          </div>

          <div id="page-emergency" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="emergency_title">
                Kontak Darurat
              </h1>
              <div
                class="instruction-box"
                style="
                  margin-bottom: 24px;
                  display: flex;
                  align-items: center;
                  gap: 12px;
                "
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="#fbc02d"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
                  />
                  <line x1="12" x2="12" y1="9" y2="13" />
                  <line x1="12" x2="12.01" y1="17" y2="17" />
                </svg>
                <span data-translate="emergency_instruction"
                  >Gunakan nomor ini hanya untuk keadaan darurat yang mengancam
                  jiwa atau properti.</span
                >
              </div>
              <div class="emergency-list">
                <div class="emergency-item" style="animation-delay: 0.1s">
                  <div
                    class="icon-wrapper"
                    style="background-color: var(--primary-color-dark)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path
                        d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                      />
                    </svg>
                  </div>
                  <div class="contact-info">
                    <h3>ERT (Emergency Response Team)</h3>
                    <p>0821-1667-7991</p>
                  </div>
                  <div class="action-buttons">
                    <a
                      href="tel:082116677991"
                      class="call-btn"
                      data-translate="emergency_call_btn"
                      >Panggil</a
                    >
                    <a
                      href="https://wa.me/6282116677991?text=emergency%20emergency%20emergency"
                      target="_blank"
                      class="whatsapp-btn"
                    >
                      <svg viewBox="0 0 24 24">
                        <path
                          d="M16.75,13.96C17.09,14.3,17.4,14.65,17.6,15C17.81,15.35,17.91,15.74,17.8,16.13C17.64,16.67,17.07,17.1,16.56,17.26C16.04,17.42,15.5,17.39,15,17.25C14.5,17.11,13.33,16.67,12.2,15.63C10.73,14.26,9.8,12.6,9.71,12.48C9.62,12.36,9.1,11.7,9.1,11C9.1,10.3,9.6,9.79,9.76,9.63C9.91,9.47,10.08,9.4,10.26,9.4C10.45,9.4,10.6,9.4,10.74,9.4C10.88,9.4,11.03,9.4,11.16,9.81C11.31,10.22,11.79,11.5,11.85,11.61C11.9,11.71,11.9,11.85,11.81,12C11.72,12.14,11.67,12.19,11.56,12.3C11.45,12.42,11.34,12.53,11.23,12.65C11.12,12.77,11.01,12.88,11.12,13.04C11.24,13.19,11.76,13.95,12.6,14.78C13.63,15.78,14.45,16.13,14.65,16.26C14.85,16.38,15.01,16.34,15.13,16.21C15.25,16.08,15.3,15.93,15.39,15.78C15.48,15.63,15.77,15.17,16.18,14.73C16.59,14.29,16.71,14.15,16.75,14.15C16.79,14.15,16.83,14.15,16.87,14.15C16.91,14.15,16.95,14.15,16.98,14.15L16.75,13.96M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22C13.81,22 15.5,21.54 16.91,20.69L20.5,22L19.31,18.41C20.42,16.89 21,15.08 21,13.13C21,7.57 17,3.13 12,3.13A9.87,9.87 0 0,0 2.2,12C2.2,16.92 6.08,20.8 11,20.8C11.33,20.8 11.67,20.77 12,20.72L12,2Z"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <div class="emergency-item" style="animation-delay: 0.2s">
                  <div class="icon-wrapper" style="background-color: #1e88e5">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path
                        d="M20.59 4.85a2.05 2.05 0 0 0-2.93 0L16.5 6l-3.5-3.5L11.5 1a2.05 2.05 0 0 0-2.93 0L3.41 6.15a2.05 2.05 0 0 0 0 2.93L5 10.5l3.5 3.5L7 15.5a2.05 2.05 0 0 0 0 2.93l5.15 5.15a2.05 2.05 0 0 0 2.93 0L21 18l-3.5-3.5L19 13a2.05 2.05 0 0 0 0-2.93Z"
                      />
                      <path d="m18 1-1 1" />
                    </svg>
                  </div>
                  <div class="contact-info">
                    <h3 data-translate="emergency_clinic">Klinik</h3>
                    <p>0813-1661-5353</p>
                  </div>
                  <div class="action-buttons">
                    <a
                      href="tel:081316615353"
                      class="call-btn"
                      data-translate="emergency_call_btn_2"
                      >Panggil</a
                    >
                    <a
                      href="https://wa.me/6281316615353?text=butuh%20medis"
                      target="_blank"
                      class="whatsapp-btn"
                    >
                      <svg viewBox="0 0 24 24">
                        <path
                          d="M16.75,13.96C17.09,14.3,17.4,14.65,17.6,15C17.81,15.35,17.91,15.74,17.8,16.13C17.64,16.67,17.07,17.1,16.56,17.26C16.04,17.42,15.5,17.39,15,17.25C14.5,17.11,13.33,16.67,12.2,15.63C10.73,14.26,9.8,12.6,9.71,12.48C9.62,12.36,9.1,11.7,9.1,11C9.1,10.3,9.6,9.79,9.76,9.63C9.91,9.47,10.08,9.4,10.26,9.4C10.45,9.4,10.6,9.4,10.74,9.4C10.88,9.4,11.03,9.4,11.16,9.81C11.31,10.22,11.79,11.5,11.85,11.61C11.9,11.71,11.9,11.85,11.81,12C11.72,12.14,11.67,12.19,11.56,12.3C11.45,12.42,11.34,12.53,11.23,12.65C11.12,12.77,11.01,12.88,11.12,13.04C11.24,13.19,11.76,13.95,12.6,14.78C13.63,15.78,14.45,16.13,14.65,16.26C14.85,16.38,15.01,16.34,15.13,16.21C15.25,16.08,15.3,15.93,15.39,15.78C15.48,15.63,15.77,15.17,16.18,14.73C16.59,14.29,16.71,14.15,16.75,14.15C16.79,14.15,16.83,14.15,16.87,14.15C16.91,14.15,16.95,14.15,16.98,14.15L16.75,13.96M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22C13.81,22 15.5,21.54 16.91,20.69L20.5,22L19.31,18.41C20.42,16.89 21,15.08 21,13.13C21,7.57 17,3.13 12,3.13A9.87,9.87 0 0,0 2.2,12C2.2,16.92 6.08,20.8 11,20.8C11.33,20.8 11.67,20.77 12,20.72L12,2Z"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <div class="emergency-item" style="animation-delay: 0.3s">
                  <div class="icon-wrapper" style="background-color: #43a047">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path d="M12 22a10 10 0 1 0-10-10h.01" />
                      <path d="M16 16c-2.5-2.5-2.5-7.5-2.5-7.5s0 5-2.5 7.5" />
                      <path d="M14 14c-1.5-1.5-1.5-4.5-1.5-4.5s0 3-1.5 4.5" />
                      <path d="M12 12c-.5-.5-.5-1.5-.5-1.5s0 1-.5 1.5" />
                    </svg>
                  </div>
                  <div class="contact-info">
                    <h3 data-translate="emergency_radio">
                      Channel Radio HSE / ERT
                    </h3>
                    <p>165.475</p>
                  </div>
                </div>
              </div>
              <div
                class="emergency-procedure"
                style="
                  margin-top: 24px;
                  text-align: center;
                  animation: fadeInUp 0.5s ease-out forwards;
                  animation-delay: 0.4s;
                  opacity: 0;
                "
              >
                <h3
                  style="margin-bottom: 16px"
                  data-translate="emergency_procedure"
                >
                  Prosedur Pelaporan Darurat
                </h3>
                <img
                  src="assets/cara_lapor_ert.png"
                  alt="Cara Lapor ERT"
                  style="
                    max-width: 100%;
                    border-radius: 12px;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                  "
                />
              </div>
            </main>
          </div>

          <!-- PLACEHOLDER PAGES -->
          <div id="page-buku-operator" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="page_op_handbook">
                Buku Saku Operator
              </h1>
              <p data-translate="page_soon">Konten akan segera hadir...</p>
            </main>
          </div>
          <div id="page-buku-mekanik" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="page_mech_handbook">
                Buku Saku Mekanik
              </h1>
              <p data-translate="page_soon_2">Konten akan segera hadir...</p>
            </main>
          </div>
          <div id="page-buku-hse" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="page_hse_handbook">
                Buku Saku HSE GAM
              </h1>
              <p data-translate="page_soon_3">Konten akan segera hadir...</p>
            </main>
          </div>
          <div id="page-golden-rules" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="page_golden_rules">
                Golden Rules
              </h1>
              <p data-translate="page_soon_4">Konten akan segera hadir...</p>
            </main>
          </div>
          <div id="page-do-dont" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="page_do_dont">
                Do & Don't
              </h1>
              <p data-translate="page_soon_5">Konten akan segera hadir...</p>
            </main>
          </div>

          <div id="page-filosofi" class="page">
            <main class="page-content">
              <h1 class="page-title" data-translate="philosophy_title">
                Filosofi & Visi Misi
              </h1>
              <div class="filosofi-tabs">
                <button
                  class="filosofi-tab-btn active"
                  onclick="showFilosofiTab('gamitas', this)"
                >
                  GAMITAS
                </button>
                <button
                  class="filosofi-tab-btn"
                  onclick="showFilosofiTab('tc', this)"
                  data-translate="philosophy_tab_tc"
                >
                  Training Center
                </button>
              </div>

              <div id="filosofi-gamitas" class="filosofi-tab-content active">
                <div class="filosofi-content">
                  <img src="assets/logo.png" alt="Logo GAMITAS" />
                  <div class="filosofi-section">
                    <h3>Filosofi Logo</h3>
                    <ul>
                      <li>
                        <strong>Perisai:</strong> melambangkan perlindungan,
                        struktur, dan komitmen terhadap keselamatan kerja.
                      </li>
                      <li>
                        <strong>Bumi & Crescent:</strong> mencerminkan jangkauan
                        global, inklusivitas, dan visi masa depan.
                      </li>
                      <li>
                        <strong>Buku Terbuka:</strong> simbol transfer ilmu,
                        edukasi berbasis kompetensi, dan pembelajaran
                        berkelanjutan.
                      </li>
                      <li>
                        <strong>Alat Berat (Excavator & Dump Truck):</strong>
                        representasi langsung dari sektor pertambangan batubara
                        yang menjadi fokus pelatihan.
                      </li>
                      <li>
                        <strong>Warna Hijau:</strong> harapan, pertumbuhan, dan
                        keberlanjutan dalam praktik K3 dan industri.
                      </li>
                      <li>
                        <strong>Warna Emas:</strong> prestise, nilai
                        profesionalisme tinggi, dan kualitas pelatihan Gamitas.
                      </li>
                      <li>
                        <strong
                          >Tulisan â€œGAMITAS Training System &
                          Promotionâ€:</strong
                        >
                        identitas utama yang menghubungkan sistem keselamatan,
                        pelatihan, dan kampanye K3 dalam satu kesatuan
                        terintegrasi.
                      </li>
                    </ul>
                  </div>
                  <div class="filosofi-section">
                    <h3>ðŸŽ¯ Visi</h3>
                    <p>
                      Mengembangkan sistem keselamatan kerja yang adaptif dan
                      berbasis teknologi serta perilaku, lalu memperluas
                      dampaknya melalui pelatihan terstruktur dan promosi budaya
                      K3 di sektor pertambangan batubara.
                    </p>
                  </div>
                  <div class="filosofi-section">
                    <h3>ðŸš€ Misi</h3>
                    <ul>
                      <li>Membangun sistem safety yang terintegrasi.</li>
                      <li>
                        Menyusun metode pengawasan, analisis risiko, dan
                        pelaporan berbasis data untuk menciptakan lingkungan
                        kerja yang proaktif terhadap bahaya.
                      </li>
                      <li>
                        Memanfaatkan teknologi digital dalam pengelolaan
                        keselamatan.
                      </li>
                      <li>
                        Menggunakan sensor, analitik, dan platform berbasis
                        cloud untuk pemantauan dan respon K3 secara real-time.
                      </li>
                      <li>
                        Menerapkan pendekatan Behavior-Based Safety (BBS).
                      </li>
                      <li>
                        Mengobservasi, mengevaluasi, dan membentuk perilaku
                        kerja yang aman melalui coaching, simulasi, dan
                        pelatihan berkelanjutan.
                      </li>
                      <li>
                        Menyediakan pelatihan dan sertifikasi berbasis standar
                        nasional.
                      </li>
                      <li>
                        Mengacu pada SKKNI, SKKK, dan SMKP Minerba untuk
                        memastikan pelatihan sesuai regulasi dan kebutuhan
                        industri.
                      </li>
                      <li>
                        Meningkatkan kesadaran K3 melalui media promosi dan
                        branding edukatif.
                      </li>
                      <li>
                        Mengemas materi pelatihan dan promosi dalam bentuk
                        visual kreatif, konten digital, dan kampanye keselamatan
                        yang mudah diakses oleh berbagai kalangan pekerja
                        tambang.
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <div id="filosofi-tc" class="filosofi-tab-content">
                <div class="filosofi-content">
                  <img src="assets/logo_tc.png" alt="Logo Training Center" />
                  <div class="filosofi-section">
                    <h3>Filosofi Logo TRAINING CENTER</h3>
                    <ul>
                      <li>
                        <strong>Lingkaran Emas dan Biru Tua:</strong> Lingkaran
                        melambangkan kontinuitas pembelajaran dan kesatuan tim.
                        Warna emas menggambarkan keunggulan, pencapaian, dan
                        aspirasi tinggi, sedangkan biru tua mencerminkan
                        kredibilitas, stabilitas, dan komitmen profesional.
                      </li>
                      <li>
                        <strong>Cincin Luar:</strong> Teks â€œTRAINING CENTERâ€ dan
                        â€œPT GANDA ALAM MAKMURâ€ di cincin luar menunjukkan fokus
                        pada pendidikan berkelanjutan dan ikatan kuat antara
                        perusahaan dengan semua pemangku kepentingan.
                      </li>
                      <li>
                        <strong>Perisai:</strong> Bagian tengah berbentuk
                        perisai menjadi simbol perlindungan pengetahuan dan
                        keselamatan kerja.
                      </li>
                      <li>
                        <strong>Empat Kuadran Simbol:</strong>
                        <ul style="padding-left: 20px; list-style: disc">
                          <li>
                            Buku Terbuka: Melambangkan sumber ilmu dan akses
                            terbuka ke informasi.
                          </li>
                          <li>
                            Roda Gigi dengan Palang Medis: Menggambarkan sinergi
                            teknologi dan kesehatan kerja.
                          </li>
                          <li>
                            Roda Gigi Tunggal: Simbol inovasi teknik dan
                            efisiensi operasional.
                          </li>
                          <li>
                            Helm Keselamatan: Menegaskan prioritas utama:
                            keselamatan.
                          </li>
                        </ul>
                      </li>
                      <li>
                        <strong>Sinergi Elemen dan Misi:</strong> Logo ini
                        menegaskan misi TRAINING CENTER: mencetak tenaga ahli
                        yang berpengetahuan luas, handal secara teknis, peduli
                        keselamatan, dan berdaya saing tinggi.
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </main>
          </div>
        </div>

        <nav class="footer-nav">
          <ul>
            <li id="nav-home" class="active">
              <a href="#" onclick="showPage('page-home')"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                  <polyline points="9 22 9 12 15 12 15 22" /></svg
                ><span data-translate="nav_home">Home</span></a
              >
            </li>
            <li id="nav-jadwal">
              <a href="#" onclick="showPage('page-jadwal')"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M8 2v4" />
                  <path d="M16 2v4" />
                  <rect width="18" height="18" x="3" y="4" rx="2" />
                  <path d="M3 10h18" /></svg
                ><span data-translate="nav_schedule">Jadwal</span></a
              >
            </li>
            <li id="nav-induksi">
              <a href="#" onclick="showPage('page-induksi')"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"
                  /></svg
                ><span data-translate="nav_induction">Induksi</span></a
              >
            </li>
            <li id="nav-emergency">
              <a href="#" onclick="showPage('page-emergency')"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
                  />
                  <line x1="12" x2="12" y1="9" y2="13" />
                  <line x1="12" x2="12.01" y1="17" y2="17" /></svg
                ><span data-translate="nav_emergency">Darurat</span></a
              >
            </li>
            <li id="nav-logout">
              <a href="#" onclick="logout()"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                  <polyline points="16 17 21 12 16 7" />
                  <line x1="21" y1="12" x2="9" y2="12" /></svg
                ><span data-translate="nav_logout">Keluar</span></a
              >
            </li>
          </ul>
        </nav>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>

    <script>
      // --- START: LANGUAGE FEATURE ---
      const translations = {
        id: {
          app_title: "GAMITAS - Aplikasi Keselamatan Terpadu",
          splash_verified: "Terverifikasi",
          login_welcome: "Selamat Datang",
          login_select_type: "Pilih tipe login untuk melanjutkan",
          login_as_gam: "Login sebagai Karyawan GAM",
          login_as_gam_desc: "Akses fitur untuk internal perusahaan",
          login_as_partner: "Login sebagai Mitra Kerja",
          login_as_partner_desc: "Akses fitur untuk vendor dan kontraktor",
          login_simper_test: "Tes SIMPER",
          login_simper_test_desc: "Akses untuk mengikuti tes SIMPER",
          login_submission: "PENGAJUAN",
          login_submission_desc: "PERMIT TO WORK, SURAT IJIN MASUK SITE dll",
          login_no_account: "Belum punya akun?",
          login_register_now: "Daftar sekarang",
          register_create_account: "Buat Akun Baru",
          register_fullname: "Nama Lengkap",
          register_id_card: "NIK KTP",
          register_email: "Email",
          register_whatsapp: "No. WhatsApp",
          register_company: "Perusahaan",
          register_now_btn: "Daftar Sekarang",
          register_have_account: "Sudah punya akun?",
          register_login: "Login",
          menu_profile: "Profil",
          menu_logout: "Keluar",
          greeting_morning: "Selamat Pagi",
          greeting_afternoon: "Selamat Siang",
          greeting_evening: "Selamat Sore",
          greeting_night: "Selamat Malam",
          tabs_dashboard: "Dashboard",
          tabs_insight: "Insight",
          tabs_report: "Laporan",
          carousel_safety_msg: "Pesan Keselamatan",
          carousel_danger_zone: "Zona Berbahaya",
          carousel_danger_area: "Area Berbahaya",
          carousel_safety_1:
            "Selalu periksa peralatan Anda sebelum memulai pekerjaan.",
          carousel_safety_2:
            "Waspada area peledakan. Dilarang masuk tanpa izin.",
          carousel_safety_3:
            "Gunakan pelindung telinga di sekitar area genset.",
          home_featured: "Fitur Pilihan",
          feature_induction: "Induksi",
          feature_schedule: "Jadwal",
          feature_golden_rules: "Golden Rules",
          feature_do_dont: "Do & Don't",
          home_handbook: "Buku Saku",
          handbook_mechanic: "BS Mekanik",
          handbook_operator: "BS Operator",
          handbook_hse: "BS HSE",
          home_other_menus: "Menu Lain",
          feature_philosophy: "Filosofi",
          feature_digital_card: "Kartu Digital",
          feature_competency: "Kompetensi",
          feature_emergency_num: "Nomor Darurat",
          nav_home: "Home",
          nav_schedule: "Jadwal",
          nav_induction: "Induksi",
          nav_emergency: "Darurat",
          nav_logout: "Keluar",
          competency_title: "Kompetensi Saya",
          competency_search_placeholder: "ðŸ” Cari nama Anda di sini...",
          competency_search_btn: "Cari",
          competency_reset_btn: "Reset",
          competency_loading: "ðŸ”„ Memuat data...",
          competency_results_title: "Status Kompetensi",
          competency_recommendation_title: "Rekomendasi Kompetensi Jabatan",
          competency_no_data: "Tidak ada data kompetensi yang ditemukan.",
          competency_no_recommendation:
            "Tidak ada rekomendasi kompetensi yang cocok.",
          digital_card_title: "Kartu Digital",
          card_behavior_1: "Memberikan Arahan yang Jelas",
          card_behavior_2: "Membuat Perencanaan Kerja yang Aman",
          card_behavior_3: "Mendelegasikan Tugas Sesuai Kompetensi K3",
          card_behavior_4: "Monitoring & Follow-Up Kegiatan K3",
          card_behavior_5: "Memberikan Dukungan & Fasilitas K3",
          card_behavior_6: "Membangun Komunikasi Positif Mengenai Safety",
          card_behavior_7: "Mengembangkan Kompetensi K3 Tim",
          card_behavior_8: "Memberikan Apresiasi Terhadap Perilaku Aman",
          card_behavior_9: "Mengelola Konflik dan Risiko Sosial",
          card_behavior_10: "Menjadi Teladan dalam Budaya K3",
          card_footer: "K3 adalah Jalan Ninjaku Menuju Keselamatan",
          schedule_title: "Jadwal Pelatihan",
          schedule_register_btn: "Pendaftaran Training",
          schedule_modal_start: "Tanggal Mulai:",
          schedule_modal_end: "Tanggal Selesai:",
          induction_title: "Induksi Keselamatan",
          induction_ready: "Siap untuk Memulai?",
          induction_instruction:
            "Silakan lakukan pendaftaran terlebih dahulu sebelum memulai proses induksi keselamatan.",
          induction_register_btn: "Pendaftaran Induksi",
          induction_start_btn: "Mulai Induksi",
          emergency_title: "Kontak Darurat",
          emergency_instruction:
            "Gunakan nomor ini hanya untuk keadaan darurat yang mengancam jiwa atau properti.",
          emergency_call_btn: "Panggil",
          emergency_call_btn_2: "Panggil",
          emergency_clinic: "Klinik",
          emergency_radio: "Channel Radio HSE / ERT",
          emergency_procedure: "Prosedur Pelaporan Darurat",
          page_op_handbook: "Buku Saku Operator",
          page_mech_handbook: "Buku Saku Mekanik",
          page_hse_handbook: "Buku Saku HSE GAM",
          page_golden_rules: "Golden Rules",
          page_do_dont: "Do & Don't",
          page_soon: "Konten akan segera hadir...",
          page_soon_2: "Konten akan segera hadir...",
          page_soon_3: "Konten akan segera hadir...",
          page_soon_4: "Konten akan segera hadir...",
          page_soon_5: "Konten akan segera hadir...",
          philosophy_title: "Filosofi & Visi Misi",
          philosophy_tab_tc: "Training Center",
        },
        en: {
          app_title: "GAMITAS - Integrated Safety Application",
          splash_verified: "Verified",
          login_welcome: "Welcome",
          login_select_type: "Select login type to continue",
          login_as_gam: "Login as GAM Employee",
          login_as_gam_desc: "Access features for company internals",
          login_as_partner: "Login as Work Partner",
          login_as_partner_desc: "Access features for vendors and contractors",
          login_simper_test: "SIMPER Test",
          login_simper_test_desc: "Access to take the SIMPER test",
          login_submission: "SUBMISSION",
          login_submission_desc: "PERMIT TO WORK, SITE ENTRY PERMIT etc.",
          login_no_account: "Don't have an account?",
          login_register_now: "Register now",
          register_create_account: "Create New Account",
          register_fullname: "Full Name",
          register_id_card: "ID Card Number",
          register_email: "Email",
          register_whatsapp: "WhatsApp Number",
          register_company: "Company",
          register_now_btn: "Register Now",
          register_have_account: "Already have an account?",
          register_login: "Login",
          menu_profile: "Profile",
          menu_logout: "Logout",
          greeting_morning: "Good Morning",
          greeting_afternoon: "Good Afternoon",
          greeting_evening: "Good Evening",
          greeting_night: "Good Night",
          tabs_dashboard: "Dashboard",
          tabs_insight: "Insight",
          tabs_report: "Report",
          carousel_safety_msg: "Safety Message",
          carousel_danger_zone: "Danger Zone",
          carousel_danger_area: "Hazardous Area",
          carousel_safety_1:
            "Always check your equipment before starting work.",
          carousel_safety_2:
            "Beware of blasting area. No entry without permission.",
          carousel_safety_3: "Use ear protection around the generator area.",
          home_featured: "Featured Features",
          feature_induction: "Induction",
          feature_schedule: "Schedule",
          feature_golden_rules: "Golden Rules",
          feature_do_dont: "Do & Don't",
          home_handbook: "Handbook",
          handbook_mechanic: "Mechanic HB",
          handbook_operator: "Operator HB",
          handbook_hse: "HSE HB",
          home_other_menus: "Other Menus",
          feature_philosophy: "Philosophy",
          feature_digital_card: "Digital Card",
          feature_competency: "Competency",
          feature_emergency_num: "Emergency No.",
          nav_home: "Home",
          nav_schedule: "Schedule",
          nav_induction: "Induction",
          nav_emergency: "Emergency",
          nav_logout: "Logout",
          competency_title: "My Competency",
          competency_search_placeholder: "ðŸ” Search your name here...",
          competency_search_btn: "Search",
          competency_reset_btn: "Reset",
          competency_loading: "ðŸ”„ Loading data...",
          competency_results_title: "Competency Status",
          competency_recommendation_title: "Job Competency Recommendation",
          competency_no_data: "No competency data found.",
          competency_no_recommendation:
            "No suitable competency recommendations found.",
          digital_card_title: "Digital Card",
          card_behavior_1: "Provide Clear Directions",
          card_behavior_2: "Create a Safe Work Plan",
          card_behavior_3: "Delegate Tasks According to OHS Competency",
          card_behavior_4: "Monitor & Follow-Up OHS Activities",
          card_behavior_5: "Provide OHS Support & Facilities",
          card_behavior_6: "Build Positive Communication About Safety",
          card_behavior_7: "Develop Team's OHS Competency",
          card_behavior_8: "Appreciate Safe Behavior",
          card_behavior_9: "Manage Conflict and Social Risks",
          card_behavior_10: "Be a Role Model in OHS Culture",
          card_footer: "Safety is my Ninja Way to Salvation",
          schedule_title: "Training Schedule",
          schedule_register_btn: "Training Registration",
          schedule_modal_start: "Start Date:",
          schedule_modal_end: "End Date:",
          induction_title: "Safety Induction",
          induction_ready: "Ready to Start?",
          induction_instruction:
            "Please register first before starting the safety induction process.",
          induction_register_btn: "Induction Registration",
          induction_start_btn: "Start Induction",
          emergency_title: "Emergency Contacts",
          emergency_instruction:
            "Use these numbers only for life-threatening or property-threatening emergencies.",
          emergency_call_btn: "Call",
          emergency_call_btn_2: "Call",
          emergency_clinic: "Clinic",
          emergency_radio: "HSE / ERT Radio Channel",
          emergency_procedure: "Emergency Reporting Procedure",
          page_op_handbook: "Operator Handbook",
          page_mech_handbook: "Mechanic Handbook",
          page_hse_handbook: "HSE GAM Handbook",
          page_golden_rules: "Golden Rules",
          page_do_dont: "Do & Don't",
          page_soon: "Content is coming soon...",
          page_soon_2: "Content is coming soon...",
          page_soon_3: "Content is coming soon...",
          page_soon_4: "Content is coming soon...",
          page_soon_5: "Content is coming soon...",
          philosophy_title: "Philosophy & Vision Mission",
          philosophy_tab_tc: "Training Center",
        },
        ko: {
          app_title: "GAMITAS - í†µí•© ì•ˆì „ ì• í”Œë¦¬ì¼€ì´ì…˜",
          splash_verified: "í™•ì¸ë¨",
          login_welcome: "í™˜ì˜í•©ë‹ˆë‹¤",
          login_select_type: "ê³„ì†í•˜ë ¤ë©´ ë¡œê·¸ì¸ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”",
          login_as_gam: "GAM ì§ì›ìœ¼ë¡œ ë¡œê·¸ì¸",
          login_as_gam_desc: "íšŒì‚¬ ë‚´ë¶€ìš© ê¸°ëŠ¥ì— ì•¡ì„¸ìŠ¤",
          login_as_partner: "ì—…ë¬´ íŒŒíŠ¸ë„ˆë¡œ ë¡œê·¸ì¸",
          login_as_partner_desc: "ê³µê¸‰ì—…ì²´ ë° ê³„ì•½ì—…ì²´ìš© ê¸°ëŠ¥ì— ì•¡ì„¸ìŠ¤",
          login_simper_test: "SIMPER í…ŒìŠ¤íŠ¸",
          login_simper_test_desc: "SIMPER í…ŒìŠ¤íŠ¸ ì‘ì‹œìš© ì•¡ì„¸ìŠ¤",
          login_submission: "ì œì¶œ",
          login_submission_desc: "ìž‘ì—… í—ˆê°€ì„œ, í˜„ìž¥ ì¶œìž… í—ˆê°€ì„œ ë“±",
          login_no_account: "ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?",
          login_register_now: "ì§€ê¸ˆ ë“±ë¡",
          register_create_account: "ìƒˆ ê³„ì • ë§Œë“¤ê¸°",
          register_fullname: "ì„±ëª…",
          register_id_card: "ì‹ ë¶„ì¦ ë²ˆí˜¸",
          register_email: "ì´ë©”ì¼",
          register_whatsapp: "WhatsApp ë²ˆí˜¸",
          register_company: "íšŒì‚¬",
          register_now_btn: "ì§€ê¸ˆ ë“±ë¡",
          register_have_account: "ì´ë¯¸ ê³„ì •ì´ ìžˆìœ¼ì‹ ê°€ìš”?",
          register_login: "ë¡œê·¸ì¸",
          menu_profile: "í”„ë¡œí•„",
          menu_logout: "ë¡œê·¸ì•„ì›ƒ",
          greeting_morning: "ì¢‹ì€ ì•„ì¹¨ìž…ë‹ˆë‹¤",
          greeting_afternoon: "ì¢‹ì€ ì˜¤í›„ìž…ë‹ˆë‹¤",
          greeting_evening: "ì¢‹ì€ ì €ë…ìž…ë‹ˆë‹¤",
          greeting_night: "ì¢‹ì€ ë°¤ìž…ë‹ˆë‹¤",
          tabs_dashboard: "ëŒ€ì‹œë³´ë“œ",
          tabs_insight: "ì¸ì‚¬ì´íŠ¸",
          tabs_report: "ë³´ê³ ì„œ",
          carousel_safety_msg: "ì•ˆì „ ë©”ì‹œì§€",
          carousel_danger_zone: "ìœ„í—˜ êµ¬ì—­",
          carousel_danger_area: "ìœ„í—˜ ì§€ì—­",
          carousel_safety_1: "ìž‘ì—… ì‹œìž‘ ì „ í•­ìƒ ìž¥ë¹„ë¥¼ í™•ì¸í•˜ì‹­ì‹œì˜¤.",
          carousel_safety_2: "ë°œíŒŒ ì§€ì—­ ì£¼ì˜. í—ˆê°€ ì—†ì´ ì¶œìž… ê¸ˆì§€.",
          carousel_safety_3: "ë°œì „ê¸° ì£¼ë³€ì—ì„œëŠ” ê·€ë§ˆê°œë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.",
          home_featured: "ì£¼ìš” ê¸°ëŠ¥",
          feature_induction: "ì•ˆì „ êµìœ¡",
          feature_schedule: "ì¼ì •",
          feature_golden_rules: "ê³¨ë“ ë£°",
          feature_do_dont: "í•´ì•¼ í•  ì¼ê³¼ í•˜ì§€ ë§ì•„ì•¼ í•  ì¼",
          home_handbook: "í•¸ë“œë¶",
          handbook_mechanic: "ì •ë¹„ì‚¬ í•¸ë“œë¶",
          handbook_operator: "ìš´ì „ìž í•¸ë“œë¶",
          handbook_hse: "HSE í•¸ë“œë¶",
          home_other_menus: "ê¸°íƒ€ ë©”ë‰´",
          feature_philosophy: "ì² í•™",
          feature_digital_card: "ë””ì§€í„¸ ì¹´ë“œ",
          feature_competency: "ì—­ëŸ‰",
          feature_emergency_num: "ë¹„ìƒ ì—°ë½ì²˜",
          nav_home: "í™ˆ",
          nav_schedule: "ì¼ì •",
          nav_induction: "ì•ˆì „ êµìœ¡",
          nav_emergency: "ë¹„ìƒ",
          nav_logout: "ë¡œê·¸ì•„ì›ƒ",
          competency_title: "ë‚˜ì˜ ì—­ëŸ‰",
          competency_search_placeholder: "ðŸ” ì—¬ê¸°ì— ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš”...",
          competency_search_btn: "ê²€ìƒ‰",
          competency_reset_btn: "ì´ˆê¸°í™”",
          competency_loading: "ðŸ”„ ë°ì´í„° ë¡œë”© ì¤‘...",
          competency_results_title: "ì—­ëŸ‰ ìƒíƒœ",
          competency_recommendation_title: "ì§ë¬´ ì—­ëŸ‰ ì¶”ì²œ",
          competency_no_data: "ì—­ëŸ‰ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
          competency_no_recommendation: "ì í•©í•œ ì—­ëŸ‰ ì¶”ì²œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
          digital_card_title: "ë””ì§€í„¸ ì¹´ë“œ",
          card_behavior_1: "ëª…í™•í•œ ì§€ì‹œ ì œê³µ",
          card_behavior_2: "ì•ˆì „í•œ ìž‘ì—… ê³„íš ìˆ˜ë¦½",
          card_behavior_3: "ì•ˆì „ë³´ê±´ ì—­ëŸ‰ì— ë”°ë¥¸ ì—…ë¬´ ìœ„ìž„",
          card_behavior_4: "ì•ˆì „ë³´ê±´ í™œë™ ëª¨ë‹ˆí„°ë§ ë° í›„ì† ì¡°ì¹˜",
          card_behavior_5: "ì•ˆì „ë³´ê±´ ì§€ì› ë° ì‹œì„¤ ì œê³µ",
          card_behavior_6: "ì•ˆì „ì— ëŒ€í•œ ê¸ì •ì  ì†Œí†µ êµ¬ì¶•",
          card_behavior_7: "íŒ€ì˜ ì•ˆì „ë³´ê±´ ì—­ëŸ‰ ê°œë°œ",
          card_behavior_8: "ì•ˆì „ í–‰ë™ì— ëŒ€í•œ ì¸ì •",
          card_behavior_9: "ê°ˆë“± ë° ì‚¬íšŒì  ìœ„í—˜ ê´€ë¦¬",
          card_behavior_10: "ì•ˆì „ë³´ê±´ ë¬¸í™”ì˜ ëª¨ë²” ë˜ê¸°",
          card_footer: "ì•ˆì „ì€ êµ¬ì›ìœ¼ë¡œ ê°€ëŠ” ë‚˜ì˜ ë‹Œìžì˜ ê¸¸",
          schedule_title: "êµìœ¡ ì¼ì •",
          schedule_register_btn: "êµìœ¡ ë“±ë¡",
          schedule_modal_start: "ì‹œìž‘ ë‚ ì§œ:",
          schedule_modal_end: "ì¢…ë£Œ ë‚ ì§œ:",
          induction_title: "ì•ˆì „ êµìœ¡",
          induction_ready: "ì‹œìž‘í•  ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?",
          induction_instruction:
            "ì•ˆì „ êµìœ¡ ì ˆì°¨ë¥¼ ì‹œìž‘í•˜ê¸° ì „ì— ë¨¼ì € ë“±ë¡í•˜ì‹­ì‹œì˜¤.",
          induction_register_btn: "ì•ˆì „ êµìœ¡ ë“±ë¡",
          induction_start_btn: "ì•ˆì „ êµìœ¡ ì‹œìž‘",
          emergency_title: "ë¹„ìƒ ì—°ë½ì²˜",
          emergency_instruction:
            "ìƒëª…ì´ë‚˜ ìž¬ì‚°ì— ìœ„í˜‘ì´ ë˜ëŠ” ë¹„ìƒ ìƒí™©ì—ë§Œ ì´ ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.",
          emergency_call_btn: "ì „í™” ê±¸ê¸°",
          emergency_call_btn_2: "ì „í™” ê±¸ê¸°",
          emergency_clinic: "í´ë¦¬ë‹‰",
          emergency_radio: "HSE / ERT ë¼ë””ì˜¤ ì±„ë„",
          emergency_procedure: "ë¹„ìƒ ë³´ê³  ì ˆì°¨",
          page_op_handbook: "ìš´ì „ìž í•¸ë“œë¶",
          page_mech_handbook: "ì •ë¹„ì‚¬ í•¸ë“œë¶",
          page_hse_handbook: "HSE GAM í•¸ë“œë¶",
          page_golden_rules: "ê³¨ë“ ë£°",
          page_do_dont: "í•´ì•¼ í•  ì¼ê³¼ í•˜ì§€ ë§ì•„ì•¼ í•  ì¼",
          page_soon: "ì½˜í…ì¸ ê°€ ê³§ ì œê³µë  ì˜ˆì •ìž…ë‹ˆë‹¤...",
          page_soon_2: "ì½˜í…ì¸ ê°€ ê³§ ì œê³µë  ì˜ˆì •ìž…ë‹ˆë‹¤...",
          page_soon_3: "ì½˜í…ì¸ ê°€ ê³§ ì œê³µë  ì˜ˆì •ìž…ë‹ˆë‹¤...",
          page_soon_4: "ì½˜í…ì¸ ê°€ ê³§ ì œê³µë  ì˜ˆì •ìž…ë‹ˆë‹¤...",
          page_soon_5: "ì½˜í…ì¸ ê°€ ê³§ ì œê³µë  ì˜ˆì •ìž…ë‹ˆë‹¤...",
          philosophy_title: "ì² í•™ ë° ë¹„ì „/ë¯¸ì…˜",
          philosophy_tab_tc: "íŠ¸ë ˆì´ë‹ ì„¼í„°",
        },
      };

      function setLanguage(lang) {
        if (!translations[lang]) return;

        localStorage.setItem("language", lang);
        document.documentElement.lang = lang;

        // --- NEW: Handle active state for flag buttons ---
        document.querySelectorAll(".lang-btn").forEach((btn) => {
          if (btn.getAttribute("data-lang") === lang) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
        // --- END NEW ---

        document.querySelectorAll("[data-translate]").forEach((el) => {
          const key = el.getAttribute("data-translate");
          if (translations[lang][key]) {
            el.textContent = translations[lang][key];
          }
        });

        document
          .querySelectorAll("[data-translate-placeholder]")
          .forEach((el) => {
            const key = el.getAttribute("data-translate-placeholder");
            if (translations[lang][key]) {
              el.placeholder = translations[lang][key];
            }
          });

        // Update document title
        if (translations[lang]["app_title"]) {
          document.title = translations[lang]["app_title"];
        }

        // Update dynamic content if needed, e.g., greetings
        const storedUserType = localStorage.getItem("userType");
        if (storedUserType) {
          updateUserUI(storedUserType);
        }
      }
      // --- END: LANGUAGE FEATURE ---

      // --- PWA Setup ---
      function setupPWA() {
        const manifest = {
          name: "GAMITAS - Aplikasi Keselamatan",
          short_name: "GAMITAS",
          description:
            "Aplikasi terpadu untuk manajemen kompetensi dan keselamatan kerja.",
          start_url: ".",
          display: "standalone",
          background_color: "#f5f5f5",
          theme_color: "#ffffff",
          icons: [
            {
              src: "assets/fav_icon.png",
              sizes: "192x192",
              type: "image/png",
              purpose: "any maskable",
            },
            {
              src: "assets/fav_icon.png",
              sizes: "512x512",
              type: "image/png",
              purpose: "any maskable",
            },
          ],
        };
        const manifestBlob = new Blob([JSON.stringify(manifest)], {
          type: "application/json",
        });
        const manifestURL = URL.createObjectURL(manifestBlob);
        document
          .querySelector('link[rel="manifest"]')
          .setAttribute("href", manifestURL);
      }

      // --- Global Variables & State ---
      let calendarInstance = null;
      let calendarRendered = false;
      let kompetensiInitialized = false;
      let lastScrollTop = 0;
      let carouselInterval;

      // --- Time-based Greeting (MODIFIED for translation) ---
      function getTimeBasedGreeting(lang) {
        const hour = new Date().getHours();
        const langPack = translations[lang] || translations["id"];
        if (hour < 12) return langPack.greeting_morning;
        if (hour < 15) return langPack.greeting_afternoon;
        if (hour < 18) return langPack.greeting_evening;
        return langPack.greeting_night;
      }

      // --- Carousel Logic ---
      function initCarousel() {
        const track = document.querySelector(".carousel-track");
        if (!track) return;
        const slides = Array.from(track.children);
        const dotsContainer = document.querySelector(".carousel-dots");
        const muteBtn = document.getElementById("mute-btn");
        const volumeOnIcon = document.getElementById("volume-on-icon");
        const volumeOffIcon = document.getElementById("volume-off-icon");
        const videos = document.querySelectorAll(".carousel-track video");
        let isMuted = true;

        dotsContainer.innerHTML = ""; // Clear existing dots
        let slideIndex = 0;

        slides.forEach((_, i) => {
          const dot = document.createElement("span");
          dot.classList.add("dot");
          if (i === 0) dot.classList.add("active");
          dot.addEventListener("click", () => {
            slideIndex = i;
            updateCarousel();
          });
          dotsContainer.appendChild(dot);
        });

        const dots = Array.from(dotsContainer.children);

        const goToNextSlide = () => {
          slideIndex = (slideIndex + 1) % slides.length;
          updateCarousel();
        };

        const resetCarouselInterval = () => {
          clearInterval(carouselInterval);
          carouselInterval = setInterval(goToNextSlide, 5000);
        };

        const updateCarousel = () => {
          track.style.transform = "translateX(-" + slideIndex * 100 + "%)";
          dots.forEach((dot) => dot.classList.remove("active"));
          if (dots[slideIndex]) {
            dots[slideIndex].classList.add("active");
          }

          clearInterval(carouselInterval);

          slides.forEach((slide, index) => {
            const video = slide.querySelector("video");
            if (video) {
              video.onended = null;
              video.pause();
              video.currentTime = 0;
            }
          });

          const currentSlide = slides[slideIndex];
          const currentVideo = currentSlide.querySelector("video");

          if (currentVideo) {
            currentVideo
              .play()
              .catch((e) => console.log("Autoplay was prevented."));
            currentVideo.onended = () => {
              goToNextSlide();
            };
          } else {
            resetCarouselInterval();
          }
        };

        muteBtn.addEventListener("click", () => {
          isMuted = !isMuted;
          videos.forEach((video) => {
            video.muted = isMuted;
          });
          volumeOnIcon.style.display = isMuted ? "none" : "block";
          volumeOffIcon.style.display = isMuted ? "block" : "none";
        });

        updateCarousel(); // Initial call to start the process
      }

      // --- Page Navigation ---
      function showPage(pageId) {
        document
          .querySelectorAll(".page")
          .forEach((page) => page.classList.remove("active"));
        const targetPage = document.getElementById(pageId);
        if (targetPage) targetPage.classList.add("active");

        const modernHeaderElements = document.querySelectorAll(
          ".user-profile, .main-tabs"
        );
        if (pageId === "page-home") {
          modernHeaderElements.forEach((el) => (el.style.display = "flex"));
          initCarousel();
        } else {
          modernHeaderElements.forEach((el) => (el.style.display = "none"));
          clearInterval(carouselInterval);
        }

        if (pageId === "page-jadwal" && !calendarRendered) initCalendar();
        if (pageId === "page-kartudigital") initDigitalCard();
        if (pageId === "page-kompetensi" && !kompetensiInitialized)
          initKompetensiPage();
        if (pageId === "page-filosofi") {
          // Set the default tab to 'gamitas' when the page is shown
          showFilosofiTab(
            "gamitas",
            document.querySelector(".filosofi-tab-btn")
          );
        }

        updateFooterNav(pageId);
        document.querySelector(".scrollable-content").scrollTo(0, 0);
      }

      function updateFooterNav(pageId) {
        document
          .querySelectorAll(".footer-nav li")
          .forEach((li) => li.classList.remove("active"));
        let navId = "nav-home";
        if (pageId.startsWith("page-")) {
          const pageName = pageId.split("-")[1];
          const navItem = document.getElementById("nav-" + pageName);
          if (navItem) {
            navId = "nav-" + pageName;
          }
        }
        const activeNav = document.getElementById(navId);
        if (activeNav) activeNav.classList.add("active");
      }

      // --- Authentication & User Flow ---
      function login(userType) {
        localStorage.setItem("userType", userType);
        const loginScreen = document.getElementById("login-screen");
        const appContainer = document.getElementById("app-container");

        loginScreen.style.animation = "fadeOut 0.5s forwards";

        setTimeout(() => {
          loginScreen.style.display = "none";
          appContainer.style.display = "flex";
          appContainer.style.animation = "fadeIn 0.5s";

          updateUserUI(userType);
          showPage("page-home");
        }, 500);
      }

      // --- MODIFIED for translation ---
      function updateUserUI(userType) {
        const currentLang = localStorage.getItem("language") || "id";

        let translatedUserType = userType;
        if (currentLang === "en") {
          translatedUserType = userType
            .replace("Karyawan GAM", "GAM Employee")
            .replace("Mitra Kerja", "Work Partner");
        } else if (currentLang === "ko") {
          translatedUserType = userType
            .replace("Karyawan GAM", "GAM ì§ì›")
            .replace("Mitra Kerja", "ì—…ë¬´ íŒŒíŠ¸ë„ˆ");
        }

        document.getElementById(
          "user-greeting"
        ).textContent = `${translatedUserType}!`;
        document.getElementById("time-greeting").textContent =
          getTimeBasedGreeting(currentLang) + ",";
        document.getElementById("header-user-name").textContent =
          userType.split(" ")[0];
        document.getElementById("profile-initial").textContent =
          userType.charAt(0);

        const kartuDigitalMenu = document.getElementById("menu-kartu-digital");
        if (userType === "Karyawan GAM") {
          kartuDigitalMenu.style.display = "";
        } else {
          kartuDigitalMenu.style.display = "none";
        }
      }

      function logout() {
        // Do not remove language preference
        const currentLang = localStorage.getItem("language");
        localStorage.clear();
        if (currentLang) {
          localStorage.setItem("language", currentLang);
        }
        window.location.reload();
      }

      function showRegisterForm() {
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("register-screen").style.display = "flex";
      }

      function showLoginForm() {
        document.getElementById("register-screen").style.display = "none";
        document.getElementById("login-screen").style.display = "flex";
      }

      function handleRegister(event) {
        event.preventDefault();
        alert("Pendaftaran berhasil! Silakan login."); // This could also be translated
        showLoginForm();
      }

      // --- App Initialization (MODIFIED for language)---
      window.addEventListener("DOMContentLoaded", () => {
        setupPWA();

        // --- START: Language Initialization ---
        const savedLang = localStorage.getItem("language") || "id";
        setLanguage(savedLang);
        // --- END: Language Initialization ---

        const splashScreen = document.getElementById("splash-screen");
        const loginScreen = document.getElementById("login-screen");
        const appContainer = document.getElementById("app-container");
        const header = document.querySelector(".app-header");
        const scrollableContent = document.querySelector(".scrollable-content");

        // Splash Screen Logic
        setTimeout(() => {
          splashScreen.classList.add("show-verified");

          setTimeout(() => {
            splashScreen.style.opacity = "0";
            splashScreen.addEventListener("transitionend", () => {
              splashScreen.style.display = "none";
            });

            // Check login status after splash
            const storedUserType = localStorage.getItem("userType");
            if (storedUserType) {
              loginScreen.style.display = "none";
              appContainer.style.display = "flex";
              updateUserUI(storedUserType);
              showPage("page-home");
            } else {
              loginScreen.style.display = "flex";
              appContainer.style.display = "none";
            }
          }, 2000); // Wait 2 seconds after checkmark
        }, 500); // Initial delay

        scrollableContent.addEventListener(
          "scroll",
          function () {
            var st = scrollableContent.scrollTop;
            if (st > lastScrollTop && st > 50) {
              header.classList.add("hidden");
            } else {
              header.classList.remove("hidden");
            }
            lastScrollTop = st <= 0 ? 0 : st;
          },
          false
        );

        // Add click listener for filosofi sections
        document.querySelectorAll(".filosofi-section").forEach((section) => {
          section.addEventListener("click", () => {
            // Remove 'zoomed' from all other sections first
            document
              .querySelectorAll(".filosofi-section.zoomed")
              .forEach((zoomedEl) => {
                if (zoomedEl !== section) {
                  zoomedEl.classList.remove("zoomed");
                }
              });
            // Then toggle the clicked one
            section.classList.toggle("zoomed");
          });
        });
      });

      // --- Page-Specific Initializers ---
      function initDigitalCard() {
        const card3d = document.querySelector(".kompetent-card");
        if (!card3d) return;
        const inner = card3d.querySelector(".card-inner");
        card3d.addEventListener("mousemove", (e) => {
          const rect = card3d.getBoundingClientRect();
          const xPos = e.clientX - rect.left;
          const yPos = e.clientY - rect.top;
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          const rotY = ((xPos - centerX) / centerX) * 10;
          const rotX = ((centerY - yPos) / centerY) * 10;
          inner.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
        });
        card3d.addEventListener("mouseleave", () => {
          inner.style.transform = "rotateX(0deg) rotateY(0deg)";
        });
        document.querySelectorAll(".behavior-list li").forEach((li) => {
          li.addEventListener("click", () => {
            li.classList.toggle("completed");
          });
        });
      }

      async function initCalendar() {
        const calendarEl = document.getElementById("calendar");
        if (!calendarEl) return;
        const modal = document.getElementById("eventModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalStart = document.getElementById("modalStart");
        const modalEnd = document.getElementById("modalEnd");
        const closeBtn = modal.querySelector(".close");
        const spreadsheetId = "1tuTh3lLiPYAUOJwCTpvsag6jqt9TZXuieSjI2Q1T42A";
        const sheetName = "training_calendar";
        const url = `https://opensheet.elk.sh/${spreadsheetId}/${sheetName}`;
        try {
          const response = await fetch(url);
          if (!response.ok)
            throw new Error(
              `Network response was not ok: ${response.statusText}`
            );
          const data = await response.json();
          const events = data.map((row) => ({
            title: row.Title,
            start: row.Start,
            end: row.End || row.Start,
          }));
          calendarInstance = new FullCalendar.Calendar(calendarEl, {
            initialView: window.innerWidth < 768 ? "listWeek" : "dayGridMonth",
            events: events,
            height: "auto",
            headerToolbar: {
              left: "prev,next today",
              center: "title",
              right: "dayGridMonth,timeGridWeek",
            },
            eventClick: function (info) {
              modalTitle.textContent = info.event.title;
              modalStart.textContent = new Date(
                info.event.start
              ).toLocaleDateString("id-ID");
              modalEnd.textContent = info.event.end
                ? new Date(info.event.end).toLocaleDateString("id-ID")
                : new Date(info.event.start).toLocaleDateString("id-ID");
              modal.style.display = "block";
            },
          });
          calendarInstance.render();
          calendarRendered = true;
          closeBtn.onclick = () => {
            modal.style.display = "none";
          };
          window.onclick = (event) => {
            if (event.target === modal) {
              modal.style.display = "none";
            }
          };
        } catch (error) {
          console.error("Gagal mengambil data dari spreadsheet:", error);
          calendarEl.innerHTML = `<p style="text-align:center; color:red;">Gagal memuat jadwal. Silakan coba lagi nanti.</p>`;
        }
      }

      // --- Kompetensi Page Logic (with Google Sheets API) ---
      const apiKey = "AIzaSyA7Wbhd7KYAMKt10vKVnJY81qDWTCs9MPw"; // WARNING: API KEY IS EXPOSED
      const spreadsheetId_kompetensi =
        "1IUZpjUEHsZe-4k4V6w1JqDNSH9zw9gKpceogu6cqx3Q";
      const sheet1Range = "BASE MANPOWER!E:I";
      const sheet2Range = "KOMPETENSI SEARCH GITHUB!B:G";
      const sheet3Range = "DEPT_JAB_GITHUB!A:E";

      function initKompetensiPage() {
        const lastSearch = localStorage.getItem("lastSearchKompetensi");
        if (lastSearch) {
          document.getElementById("search-kompetensi").value = lastSearch;
          searchData();
        }
        kompetensiInitialized = true;
      }

      function searchData() {
        const searchTerm = document
          .getElementById("search-kompetensi")
          .value.trim()
          .toLowerCase();
        if (!searchTerm) {
          alert("Silakan masukkan nama untuk mencari.");
          return;
        }
        localStorage.setItem("lastSearchKompetensi", searchTerm);
        document.getElementById("loading").style.display = "block";
        document.getElementById("results").innerHTML = "";
        const sheet1Url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId_kompetensi}/values/${sheet1Range}?key=${apiKey}`;
        const sheet2Url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId_kompetensi}/values/${sheet2Range}?key=${apiKey}`;
        const sheet3Url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId_kompetensi}/values/${sheet3Range}?key=${apiKey}`;
        Promise.all([
          fetch(sheet1Url).then((res) => res.json()),
          fetch(sheet2Url).then((res) => res.json()),
          fetch(sheet3Url).then((res) => res.json()),
        ])
          .then(([data1, data2, data3]) => {
            const manpowerResults = (data1.values || []).filter(
              (row) =>
                row &&
                row[0] &&
                typeof row[0] === "string" &&
                row[0].toLowerCase().includes(searchTerm)
            );
            const competencyResults = (data2.values || []).filter(
              (row) =>
                row &&
                row[0] &&
                typeof row[0] === "string" &&
                row[0].toLowerCase().includes(searchTerm)
            );
            const recommendationData = data3.values || [];

            const currentLang = localStorage.getItem("language") || "id";
            const langPack = translations[currentLang];

            displayKompetensiResults(
              competencyResults,
              langPack.competency_results_title
            );
            displayCompetencyRecommendations(
              manpowerResults,
              recommendationData,
              competencyResults.length,
              langPack.competency_recommendation_title,
              langPack.competency_no_recommendation
            );

            document.getElementById("loading").style.display = "none";
          })
          .catch((error) => {
            console.error("Gagal mengambil data:", error);
            document.getElementById("loading").innerHTML =
              "Terjadi kesalahan saat mengambil data.";
          });
      }

      function displayKompetensiResults(results, sectionTitle) {
        const currentLang = localStorage.getItem("language") || "id";
        const langPack = translations[currentLang];
        const resultsDiv = document.getElementById("results");
        const section = document.createElement("section");
        section.className = "result-section";
        const title = document.createElement("h2");
        title.innerText = sectionTitle;
        section.appendChild(title);

        const listContainer = document.createElement("div");
        listContainer.className = "grid-4";

        if (!results || results.length === 0) {
          const noDataMessage = document.createElement("p");
          noDataMessage.textContent = langPack.competency_no_data;
          section.appendChild(noDataMessage);
        } else {
          results.forEach((row, index) => {
            const item = document.createElement("div");
            item.className = "grid-card";
            item.style.animationDelay = `${index * 0.05}s`;

            let icon =
              "https://cdn-icons-png.flaticon.com/512/4213/4213843.png"; // Default: Help/Unknown
            let label = row[3] || "Pelatihan Tidak Terdaftar";
            let status = row[4];

            if (status === "Y") {
              icon = "https://cdn-icons-png.flaticon.com/512/190/190411.png"; // Check
            } else if (status === "OFF") {
              icon = "https://cdn-icons-png.flaticon.com/512/1828/1828843.png"; // Cross
            } else if (status === "Y/I") {
              icon = "https://cdn-icons-png.flaticon.com/512/107/107144.png"; // Hourglass/Pending
            }

            item.innerHTML = `
                    <img src="${icon}" alt="Status Icon" />
                    <p>${label}</p>
                `;
            listContainer.appendChild(item);
          });
          section.appendChild(listContainer);
        }
        resultsDiv.appendChild(section);
      }

      function displayCompetencyRecommendations(
        manpowerResults,
        recommendationData,
        competencyCount = 0,
        sectionTitle,
        noDataText
      ) {
        const resultsDiv = document.getElementById("results");
        const section = document.createElement("section");
        section.className = "result-section";
        const title = document.createElement("h2");
        title.innerText = sectionTitle;
        section.appendChild(title);

        const listContainer = document.createElement("div");
        listContainer.className = "grid-4";

        const matches = [];
        const uniqueRoles = new Set();

        manpowerResults.forEach((row) => {
          const dept = row[1]?.trim().toLowerCase();
          const jabatan = row[4]?.trim().toLowerCase();
          if (dept && jabatan) uniqueRoles.add(`${dept}|${jabatan}`);
        });

        uniqueRoles.forEach((roleKey) => {
          const [deptKey, jabKey] = roleKey.split("|");
          recommendationData.forEach((row3) => {
            const dept3 = row3[0]?.trim().toLowerCase();
            const jab3 = row3[2]?.trim().toLowerCase();
            const namaPelatihan = row3[4];
            if (dept3 === deptKey && jab3 === jabKey && namaPelatihan) {
              const key = `${jab3}|${namaPelatihan}`;
              if (!matches.some((item) => item.key === key)) {
                matches.push({ namaPelatihan, key });
              }
            }
          });
        });

        if (matches.length === 0) {
          const noDataMessage = document.createElement("p");
          noDataMessage.textContent = noDataText;
          section.appendChild(noDataMessage);
        } else {
          matches.forEach((item, index) => {
            const listItem = document.createElement("div");
            listItem.className = "grid-card";
            listItem.style.animationDelay = `${
              (competencyCount + index) * 0.05
            }s`;

            listItem.innerHTML = `
                    <img src="https://cdn-icons-png.flaticon.com/512/3063/3063823.png" alt="Rekomendasi Icon" />
                    <p>${item.namaPelatihan}</p>
                `;
            listContainer.appendChild(listItem);
          });
          section.appendChild(listContainer);
        }
        resultsDiv.appendChild(section);
      }

      function resetSearch() {
        document.getElementById("search-kompetensi").value = "";
        document.getElementById("results").innerHTML = "";
        document.getElementById("loading").style.display = "none";
        localStorage.removeItem("lastSearchKompetensi");
      }

      function showFilosofiTab(tabId, clickedButton) {
        document
          .querySelectorAll(".filosofi-tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".filosofi-tab-content")
          .forEach((content) => content.classList.remove("active"));

        clickedButton.classList.add("active");
        document.getElementById("filosofi-" + tabId).classList.add("active");
      }
    </script>
  </body>
</html>
